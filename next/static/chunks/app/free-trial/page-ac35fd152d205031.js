(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{1735:(e,t,r)=>{Promise.resolve().then(r.bind(r,1878))},1878:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(5155),s=r(2115),l=r(1978),i=r(6927),n=r(5695),o=r(6553),d=r(2158),c=r(7021),u=r(6766),m=r(6874),h=r.n(m),b=r(3297);function x(){let e=(0,n.useRouter)(),{user:t,loading:r}=(0,o.J)(),[m,x]=(0,s.useState)(""),[g,f]=(0,s.useState)(""),[p,y]=(0,s.useState)(""),[w,v]=(0,s.useState)(""),[j,N]=(0,s.useState)((0,c.oO)()),[P,k]=(0,s.useState)(!1),[S,_]=(0,s.useState)(""),[C,T]=(0,s.useState)(""),[A,F]=(0,s.useState)(!1),[O,E]=(0,s.useState)(!1),[z,I]=(0,s.useState)(""),[U,D]=(0,s.useState)("checking");(0,s.useEffect)(()=>{(async()=>{if(!r)if(t)try{let{data:e,error:r}=await i.N.from("free_trials").select("trial_status").eq("user_id",t.id).single();r&&"PGRST116"!==r.code&&(b.A.error("Error checking trial status:",r),_("Failed to check trial eligibility. Please try again.")),e?D("utilized"):D("available")}catch(e){b.A.error("Unexpected error checking trial status:",e),_("An unexpected error occurred. Please try again.")}else D("available")})()},[t,r]);let V=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),Y=e=>e.length>=10,R=async e=>{if(e&&e.preventDefault(),!m||!g||!p||!w)return void _("Please fill in all fields.");if(!P)return void _("You must agree to the Terms and Conditions.");if(!V(m))return void _("Please enter a valid email.");if(!Y(w))return void _("Please enter a valid mobile number for ".concat(j.name,"."));if(g!==p)return void _("Passwords do not match.");if(g.length<6)return void _("Password must be at least 6 characters.");F(!0);try{b.A.log("Attempting signup with email:",m);let e=(0,c.n4)(j.dialCode,w),t=m.split("@")[0],{data:r}=await i.N.auth.signInWithPassword({email:m,password:g});if(null==r?void 0:r.user){let{data:e}=await i.N.from("free_trials").select("trial_status").eq("user_id",r.user.id).single();if(e){_("Free Trial Already Utilized. Please check our paid plans."),D("utilized"),F(!1);return}E(!0),T("Please enter the OTP sent to your mobile number."),F(!1);return}let{error:a}=await i.N.auth.signUp({email:m,password:g,options:{data:{mobile:e,country_code:j.dialCode,username:t}}});if(a){b.A.error("Signup error:",a),a.message.includes("already registered")?_("An account with this email already exists. Please try logging in."):_(a.message);return}E(!0),T("Please enter the OTP sent to your mobile number.")}catch(e){b.A.error("Unexpected signup error:",e),_("An unexpected error occurred. Please try again.")}finally{F(!1)}},q=async()=>{if(!z||z.length<6)return void _("Please enter a valid OTP.");F(!0);try{let{error:r}=await i.N.from("free_trials").insert({user_id:null==t?void 0:t.id,email:m,phone_number:(0,c.n4)(j.dialCode,w),trial_status:"active",created_at:new Date().toISOString(),expires_at:new Date(Date.now()+864e5).toISOString()}).select();if(r){b.A.error("Error creating free trial:",r),_("Failed to create your free trial. Please try again.");return}T("Your free trial has been created successfully! Redirecting to dashboard..."),setTimeout(()=>{e.push("/dashboard")},3e3)}catch(e){b.A.error("OTP verification error:",e),_("Failed to verify OTP. Please try again.")}finally{F(!1)}};return(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-4 md:p-24 bg-gradient-to-b from-black to-gray-900",children:(0,a.jsx)("div",{className:"max-w-md w-full",children:(0,a.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6 md:p-8 shadow-xl",children:[(0,a.jsx)("div",{className:"flex justify-center mb-6",children:(0,a.jsx)(u.default,{src:"/assets/vecrahost-logo.svg",alt:"VecraHost Logo",width:60,height:60,className:"h-12 w-auto"})}),(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-center text-white mb-2",children:"Start Your 24-Hour Free Trial"}),(0,a.jsx)("p",{className:"text-gray-400 text-center mb-8",children:"Instant setup. Verify your mobile to begin."}),S&&(0,a.jsx)("div",{className:"mb-6 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-sm",children:S}),C&&(0,a.jsx)("div",{className:"mb-6 p-3 bg-green-500/10 border border-green-500/20 rounded-lg text-green-400 text-sm",children:C}),"checking"===U?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-white"})}):"utilized"===U?(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsxs)("div",{className:"mb-6 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg text-yellow-400",children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:"Free Trial Already Utilized"}),(0,a.jsx)("p",{children:"You have already used your free trial. Please check our paid plans."})]}),(0,a.jsx)(h(),{href:"/#pricing",className:"inline-block px-6 py-3 bg-accent hover:bg-accent/80 text-white rounded-lg transition-colors",children:"See Paid Plans"})]}):O?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-300 mb-1",children:"Enter OTP sent to your mobile"}),(0,a.jsx)("input",{id:"otp",type:"text",value:z,onChange:e=>I(e.target.value),placeholder:"Enter 6-digit OTP",className:"w-full bg-white/10 p-3 rounded-lg border border-white/10 focus:outline-none text-white",maxLength:6})]}),(0,a.jsx)("button",{onClick:q,disabled:A,className:"w-full bg-accent hover:bg-accent/80 text-white py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Verifying..."]}):"Verify & Start Free Trial"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),(0,a.jsx)("input",{id:"email",type:"email",value:m,onChange:e=>x(e.target.value),placeholder:"your@email.com",className:"w-full bg-white/10 p-3 rounded-lg border border-white/10 focus:outline-none text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",value:g,onChange:e=>f(e.target.value),placeholder:"••••••••",className:"w-full bg-white/10 p-3 rounded-lg border border-white/10 focus:outline-none text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-1",children:"Confirm Password"}),(0,a.jsx)("input",{id:"confirmPassword",type:"password",value:p,onChange:e=>y(e.target.value),placeholder:"••••••••",className:"w-full bg-white/10 p-3 rounded-lg border border-white/10 focus:outline-none text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"mobile",className:"block text-sm font-medium text-gray-300 mb-1",children:"Mobile Number"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d.A,{selectedCountry:j,onCountryChange:N}),(0,a.jsx)("input",{id:"mobile",type:"tel",value:w,onChange:e=>v(e.target.value),placeholder:"Mobile Number",className:"flex-1 bg-white/10 p-3 rounded-lg border border-white/10 focus:outline-none text-white"})]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("input",{id:"terms",type:"checkbox",checked:P,onChange:e=>k(e.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent"}),(0,a.jsxs)("label",{htmlFor:"terms",className:"ml-2 block text-sm text-gray-400",children:["I agree to the"," ",(0,a.jsx)(h(),{href:"/terms-of-service",className:"text-accent hover:underline",children:"Terms of Service"})," ","and"," ",(0,a.jsx)(h(),{href:"/privacy-policy",className:"text-accent hover:underline",children:"Privacy Policy"})]})]}),(0,a.jsx)("button",{type:"button",onClick:R,disabled:A,className:"w-full bg-accent hover:bg-accent/80 text-white py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsx)("span",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Processing..."]}):"Start Free Trial Now"}),(0,a.jsxs)("p",{className:"text-center text-sm text-gray-400",children:["Already have an account?"," ",(0,a.jsx)(h(),{href:"/",className:"text-accent hover:underline",children:"Sign in"})]})]})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[766,874,978,28,124,441,684,358],()=>t(1735)),_N_E=e.O()}]);