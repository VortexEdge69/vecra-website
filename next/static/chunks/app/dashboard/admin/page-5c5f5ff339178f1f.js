(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{425:(e,t,s)=>{Promise.resolve().then(s.bind(s,7551))},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},6553:(e,t,s)=>{"use strict";s.d(t,{J:()=>o,UserProvider:()=>l});var r=s(5155),a=s(2115),i=s(6927);let n=(0,a.createContext)(void 0),l=e=>{let{children:t}=e,[s,l]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{try{console.log("Restoring session...");let{data:{session:e}}=await i.N.auth.getSession();console.log("Session restore result:",e?"Found session":"No session"),(null==e?void 0:e.user)&&(console.log("Setting user from session:",e.user.email),l(e.user),c(e))}catch(e){console.error("Error restoring session:",e)}finally{u(!1)}})();let{data:{subscription:e}}=i.N.auth.onAuthStateChange((e,t)=>{console.log("Auth state change:",e,t?"Session exists":"No session"),(null==t?void 0:t.user)?(console.log("Setting user from auth change:",t.user.email),l(t.user),c(t)):(console.log("Clearing user from auth change"),l(null),c(null)),u(!1)});return()=>{e.unsubscribe()}},[]),(0,r.jsx)(n.Provider,{value:{user:s,session:o,loading:d,setUser:l,setSession:c},children:t})},o=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},6654:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let r=s(2115);function a(e,t){let s=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=s.current;e&&(s.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(s.current=i(e,r)),t&&(a.current=i(t,r))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6927:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(5647).UU)("https://dywimbkhjtkxmpmxdfru.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR5d2ltYmtoanRreG1wbXhkZnJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwMDU0MDUsImV4cCI6MjA3NDU4MTQwNX0.I1YyPJyVucYDmUqQN3YDAaztuS6XmFhtnKX7ZFEFNzo")},7551:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(5155),a=s(2115),i=s(5695),n=s(1978),l=s(6927),o=s(6553),c=s(6874),d=s.n(c);function u(){return(0,r.jsx)(n.P.nav,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/5 backdrop-blur-lg border-b border-white/10 sticky top-0 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 md:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"VecraHost Admin"}),(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:"Admin Panel"})]}),(0,r.jsxs)(d(),{href:"/",className:"bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,r.jsx)("span",{children:"Back to Site"})]})]})})})}function m(){let e=(0,i.useRouter)(),{user:t,loading:s}=(0,o.J)(),[c,d]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0),[x,p]=(0,a.useState)(""),[f,g]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[y,N]=(0,a.useState)(""),[j,v]=(0,a.useState)({adminEmails:"",discordWebhook:"",newUserNotifications:!0,paymentNotifications:!0});(0,a.useEffect)(()=>{(async()=>{if(!s){if(!t){p("Please log in to access admin dashboard"),h(!1),setTimeout(()=>e.push("/"),2e3);return}try{let{data:s,error:r}=await l.N.from("profiles").select("is_admin, email").eq("id",t.id).single();if(r){p("Database error: ".concat(r.message)),h(!1);return}if(!s){p("No profile found for user"),h(!1);return}if(!s.is_admin){p("Access denied: Admin privileges required"),h(!1),setTimeout(()=>e.push("/"),2e3);return}d(!0),h(!1),k()}catch(e){p("Authentication error: ".concat(e)),h(!1)}}})()},[t,s,e]);let k=async()=>{try{let{data:e,error:t}=await l.N.from("profiles").select("id, email, created_at, account_status, is_admin").order("created_at",{ascending:!1});if(t)throw t;g(e||[]);let{data:s,error:r}=await l.N.from("payments").select("*").order("created_at",{ascending:!1});if(r)throw r;w(s||[]);let a=localStorage.getItem("adminNotificationSettings");a&&v(JSON.parse(a))}catch(e){console.error("Error loading dashboard data:",e)}},S=async(e,t)=>{try{let{error:s}=await l.N.from("profiles").update({account_status:t}).eq("id",e);if(s)throw s;g(f.map(s=>s.id===e?{...s,account_status:t}:s)),j.newUserNotifications&&console.log("User status updated notification would be sent")}catch(e){console.error("Error updating user status:",e)}},C=async(e,t)=>{try{console.log("Updating payment ".concat(e," to status: ").concat(t));let{data:s,error:r}=await l.N.from("payments").update({status:t}).eq("id",e).select();if(r)throw console.error("Error updating payment status:",r),console.error("Error details:",{message:r.message,details:r.details,hint:r.hint,code:r.code}),Error("Failed to update payment: ".concat(r.message));console.log("Payment updated successfully:",s),w(b.map(s=>s.id===e?{...s,status:t}:s)),j.paymentNotifications&&console.log("Payment status updated notification would be sent")}catch(e){console.error("Error updating payment status:",e),alert("Failed to update payment status: ".concat(e instanceof Error?e.message:"Unknown error"))}},_=f.filter(e=>{var t,s;return((null==(t=e.email)?void 0:t.toLowerCase())||"").includes(y.toLowerCase())||((null==(s=e.account_status)?void 0:s.toLowerCase())||"").includes(y.toLowerCase())}),P=b.filter(e=>{var t,s,r;return((null==(t=e.email)?void 0:t.toLowerCase())||"").includes(y.toLowerCase())||((null==(s=e.plan_name)?void 0:s.toLowerCase())||"").includes(y.toLowerCase())||((null==(r=e.status)?void 0:r.toLowerCase())||"").includes(y.toLowerCase())});return m?(0,r.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-white text-xl mb-4",children:"Loading admin dashboard..."}),x&&(0,r.jsx)("div",{className:"text-red-400 text-sm max-w-md",children:x})]})}):c?(0,r.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,r.jsx)(u,{}),(0,r.jsx)("div",{className:"p-4 md:p-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[(0,r.jsx)(n.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Admin Dashboard"}),(0,r.jsx)("p",{className:"text-gray-300",children:"Manage users, payments, and system notifications"})]}),(0,r.jsxs)("button",{onClick:k,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]})]})}),(0,r.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6",children:(0,r.jsx)("input",{type:"text",placeholder:"Search users, payments, or status...",value:y,onChange:e=>N(e.target.value),className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)(n.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-white mb-6",children:["Users (",_.length,")"]}),(0,r.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto custom-scrollbar",children:_.map(e=>(0,r.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:e.email}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:["Joined: ",new Date(e.created_at).toLocaleDateString()]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:e.is_admin&&(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full",children:"Admin"})})]}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsxs)("select",{value:e.account_status,onChange:t=>S(e.id,t.target.value),className:"bg-white/10 border border-white/20 rounded px-3 py-1 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"active",children:"Active"}),(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"suspended",children:"Suspended"})]})})]},e.id))})]}),(0,r.jsxs)(n.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-white mb-6",children:["Payments (",P.length,")"]}),(0,r.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto custom-scrollbar",children:P.map(e=>(0,r.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("p",{className:"text-white font-medium",children:e.email}),(0,r.jsxs)("p",{className:"text-sm text-gray-400",children:[e.plan_name," - â‚¹",e.amount," (",e.billing_period," months)"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 font-mono",children:["UTR: ",e.utr_number]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("approved"===e.status?"bg-green-500/20 text-green-400":"rejected"===e.status?"bg-red-500/20 text-red-400":"bg-yellow-500/20 text-yellow-400"),children:e.status}),"pending"===e.status&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>C(e.id,"approved"),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-xs rounded transition-colors",children:"Approve"}),(0,r.jsx)("button",{onClick:()=>C(e.id,"rejected"),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-xs rounded transition-colors",children:"Reject"})]})]})]},e.id))})]})]}),(0,r.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white/5 backdrop-blur-lg border border-white/10 rounded-2xl p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Notification Settings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Admin Email Addresses"}),(0,r.jsx)("textarea",{value:j.adminEmails,onChange:e=>v({...j,adminEmails:e.target.value}),placeholder:"admin@example.com, support@example.com",className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Separate multiple emails with commas"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Discord Webhook URL"}),(0,r.jsx)("input",{type:"url",value:j.discordWebhook,onChange:e=>v({...j,discordWebhook:e.target.value}),placeholder:"https://discord.com/api/webhooks/...",className:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,r.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Integration coming soon"})]})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:"New User Notifications"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get notified when new users register"})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:j.newUserNotifications,onChange:e=>v({...j,newUserNotifications:e.target.checked}),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:"Payment Notifications"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Get notified when payments are submitted"})]}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:j.paymentNotifications,onChange:e=>v({...j,paymentNotifications:e.target.checked}),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-11 h-6 bg-white/20 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),(0,r.jsx)("button",{onClick:()=>{localStorage.setItem("adminNotificationSettings",JSON.stringify(j))},className:"mt-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors",children:"Save Settings"})]})]})})]}):(0,r.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-400 text-xl mb-4",children:"Access Denied"}),(0,r.jsx)("div",{className:"text-gray-400 text-sm mb-4",children:x||"Admin privileges required"}),(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Return to Home"})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,978,28,441,684,358],()=>t(425)),_N_E=e.O()}]);